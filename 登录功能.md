templates/login.html的form表单加入
```
{% csrf_token %}
```
blogauth/views.py的blogin方法
```
@require_http_methods(['GET','POST'])
def blogin(request):
    if request.method == 'GET':
        return render(request, 'login.html')
    else:
        form = LoginForm(request.POST)
        if form.is_valid():
            email = form.cleaned_data.get('email')
            password = form.cleaned_data.get('password')
            remember = form.cleaned_data.get('remember')
            user = User.objects.filter(email=email).first()
            if user and user.check_password(password):
                #登录
                login(request, user)
                if not remember:
                    #如果没有点击记住我，那么就要设置过期时间为0，即浏览器关闭后就会过期
                    request.session.set_expiry(0)
                #如果点击了，那么就使用默认的2周的过期时间
                return redirect('/')
            else:
                print('邮箱或密码错误!')
                return redirect(reverse('blogauth:login'))
```
templates/base.html的登录注册按钮改为超链接形式
```
<div class="text-end">
                <a href="{% url 'blogauth:login' %}" type="button" class="btn btn-outline-primary me-2" _msttexthash="5298241" _msthash="34">登录</a>
                <a href="{% url 'blogauth:register' %}" type="button" class="btn btn-primary" _msttexthash="4708184" _msthash="35">注册</a>
            </div>
```
在form表单后添加如下代码
```
{% if user.is_authenticated %}
                <div class="dropdown text-end"><a href="#"
                                                  class="d-block link-body-emphasis text-decoration-none dropdown-toggle show"
                                                  data-bs-toggle="dropdown" aria-expanded="true"> <img
                        src="https://github.com/mdo.png" alt="MDO" width="32" height="32" class="rounded-circle"
                        _mstalt="33306" _msthash="42"> </a>
                    <ul class="dropdown-menu text-small show"
                        style="position: absolute; inset: 0px auto auto 0px; margin: 0px; transform: translate3d(0px, 34.4px, 0px);"
                        _mstvisible="0" data-popper-placement="bottom-start">
                        <li _mstvisible="1"><a class="dropdown-item" href="#" _msttexthash="10035376" _msthash="43"
                                               _mstvisible="2">新项目......</a></li>
                        <li _mstvisible="1"><a class="dropdown-item" href="#" _msttexthash="6648122" _msthash="44"
                                               _mstvisible="2">设置</a></li>
                        <li _mstvisible="1"><a class="dropdown-item" href="#" _msttexthash="4974840" _msthash="45"
                                               _mstvisible="2">简介</a></li>
                        <li _mstvisible="1">
                            <hr class="dropdown-divider" _mstvisible="2">
                        </li>
                        <li _mstvisible="1"><a class="dropdown-item" href="#" _msttexthash="5059418" _msthash="46"
                                               _mstvisible="2">签出</a></li>
                    </ul>
                </div>
{% else %}
                <div class="text-end">
                    <a href="{% url 'blogauth:login' %}" type="button" class="btn btn-outline-primary me-2"
                       _msttexthash="5298241" _msthash="34">登录</a>
                    <a href="{% url 'blogauth:register' %}" type="button" class="btn btn-primary" _msttexthash="4708184"
                       _msthash="35">注册</a>
                </div>
{% endif %}
```
添加一个blogout方法(退出登录)
```
def blogout(request):
    logout(request)
    return redirect('/')
```
在blogauth/urls.py添加路由映射
```
path('logout/', views.blogout, name='logout'),
```
base.html修改一下href
```
<ul class="dropdown-menu text-small show" style="">
  <li><a class="dropdown-item" href="{% url 'blogauth:logout' %}">退出登录</a></li>
</ul>
```
